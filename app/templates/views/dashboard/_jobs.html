{% from "components/table.html" import list_table, field, right_aligned_field_heading %}
{% from "components/big-number.html" import big_number %}

{% call(item, row_number) list_table(
  jobs,
  caption="Recent batch jobs",
  caption_visible=False,
  empty_message='You havenâ€™t sent any batch messages yet',
  field_headings=[
    'File',
    right_aligned_field_heading('Sending'),
    right_aligned_field_heading('Delivered'),
    right_aligned_field_heading('Failed')
  ],
  field_headings_visible=True
) %}
  {% call field() %}
    <div class="file-list">
      <a class="file-list-filename" href="{{ url_for('.view_job', service_id=current_service.id, job_id=item.id) }}">{{ item.original_file_name }}</a>
      <span class="file-list-hint">Uploaded {{ item.created_at|format_datetime_short }}</span>
    </div
  {% endcall %}
  {% call field(align='right') %}
    {{ big_number(
      item.get('notifications_sent', 0) - item.get('notifications_delivered', 0) - item.get('notifications_failed', 0),
      smaller=True
    ) }}
  {% endcall %}
  {% call field(align='right') %}
    {{ big_number(item.get('notifications_delivered', 0), smaller=True) }}
  {% endcall %}
  {% call field(align='right', status='error' if 0 else '') %}
    {{ big_number(item.get('notifications_failed', 0), smaller=True) }}
  {% endcall %}
{% endcall %}
