{% extends "withnav_template.html" %}
{% from "components/table.html" import list_table, field, hidden_field_heading %}

{% block page_title %}
  GOV.UK Notify | API keys and documentation
{% endblock %}

{% block maincolumn_content %}

  <h1 class="heading-xlarge">
    API keys
  </h1>

  <p>
    To connect to the API you will need to create an API Key. Each service can have multiple API Keys to allow
    for test and live environments.
  </p>

  <p>
    API usage is described in
    <a href="{{ url_for('.documentation', service_id=service_id) }}">the
    developer documentation</a>.
  </p>

  <h2 class="api-key-name">
    Service ID
  </h2>
  <p class="api-key-key">
    {{ service_id }}
  </p>

  {% call(item) list_table(
    keys,
    empty_message="You havenâ€™t created any API keys yet",
    caption="API keys",
    caption_visible=False,
    field_headings=['Key name', hidden_field_heading('Action')]
  ) %}
    {% call field() %}
      {{ item.name }}
    {% endcall %}
    {% if item.expiry_date %}
      {% call field(align='right', status='default') %}
        Revoked {{ item.expiry_date|format_datetime }}
      {% endcall %}
    {% else %}
      {% call field(align='right', status='error') %}
        <a href='{{ url_for('.revoke_api_key', service_id=service_id, key_id=item.id) }}'>Revoke</a>
      {% endcall %}
    {% endif %}
  {% endcall %}

  <p>
    <a href="{{ url_for('.create_api_key', service_id=service_id) }}">Create a new API key</a>
  </p>

{% endblock %}
