{% extends "withnav_template.html" %}
{% from "components/browse-list.html" import browse_list %}
{% from "components/table.html" import mapping_table, row, text_field, edit_field %}

{% block page_title %}
  Settings â€“ GOV.UK Notify
{% endblock %}

{% block maincolumn_content %}

    <h1 class="heading-large">Settings</h1>

    {% call mapping_table(
      caption='Settings',
      field_headings=['Label', 'Value', 'Action'],
      field_headings_visible=False,
      caption_visible=False
    ) %}
      {% call row() %}
        {{ text_field('Service name' )}}
        {{ text_field(current_service.name) }}
        {{ edit_field('Change', url_for('.service_name_change', service_id=current_service.id)) }}
      {% endcall %}
      {% call row() %}
        {{ text_field('Email reply to address')}}
        {{ text_field(current_service.reply_to_email_address) }}
        {{ edit_field('Change', url_for('.service_set_reply_to_email', service_id=current_service.id)) }}
      {% endcall %}
      {% call row() %}
        {{ text_field('Text message sender')}}
        {{ text_field(current_service.sms_sender or '40604') }}
        {{ edit_field('Change', url_for('.service_set_sms_sender', service_id=current_service.id)) }}
      {% endcall %}
      {% call row() %}
        {{ text_field('Mode')}}
        {% if current_service.restricted %}
          {{ text_field('Trial') }}
          {{ edit_field('Go live', url_for('.service_request_to_go_live', service_id=current_service.id)) }}
        {% else %}
          {{ text_field('Live') }}
          {{ edit_field() }}
        {% endif %}
      {% endcall %}
      {% call row() %}
        {{ text_field('Active')}}
        {{ text_field(current_service.active) }}
        {{ edit_field('Suspend', url_for('.service_status_change', service_id=current_service.id)) }}
      {% endcall %}
    {% endcall %}

    {% if current_user.has_permissions([], admin_override=True) %}

      <h2 class="heading-large">Platform admin settings</h2>

      {{ browse_list([
        {
          'title': 'Set email branding',
          'link': url_for('.service_set_branding_and_org', service_id=current_service.id)
        },
        {
          'title': 'Make service live',
          'link': url_for('.service_switch_live', service_id=current_service.id)
        } if current_service.restricted else {
          'title': 'Revert service to trial',
          'link': url_for('.service_switch_live', service_id=current_service.id)
        },
        {
          'title': 'Put service into research mode',
          'link': url_for('.service_switch_research_mode', service_id=current_service.id)
        } if not current_service.research_mode else {
          'title': 'Take service out of research mode',
          'link': url_for('.service_switch_research_mode', service_id=current_service.id)
        }
      ]) }}

    {% endif %}

{% endblock %}
